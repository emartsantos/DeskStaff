import{a as l,p as n,v as x}from"./chunk-EPOLDU6W-BHelFxtI.js";import{P as k}from"./card-DCCwVGqU.js";import{a as w,c as f,L as N}from"./loader-circle-B5kmy_fB.js";import{s as d}from"./supabase-ABfmbsGw.js";var E="Label",m=l.forwardRef((a,t)=>n.jsx(k.label,{...a,ref:t,onMouseDown:e=>{e.target.closest("button, input, select, textarea")||(a.onMouseDown?.(e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));m.displayName=E;var L=m;function D({className:a,...t}){return n.jsx(L,{"data-slot":"label",className:w("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...t})}const j=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],P=f("check",j);const v=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],R=f("eye-off",v);const I=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],O=f("eye",I);function U({children:a,requireAuth:t=!0,redirectTo:e="/"}){const i=x(),[h,r]=l.useState(!0),[g,p]=l.useState(!1),[M,y]=l.useState(null);l.useEffect(()=>{b()},[]);const b=async()=>{try{const{data:{session:o},error:u}=await d.auth.getSession();if(u)throw console.error("Session error:",u),u;if(!!!o)if(t){console.log("No session found, redirecting to login"),i("/",{replace:!0}),r(!1);return}else{p(!0),r(!1);return}if(t){const{data:c,error:s}=await d.from("users").select("id").eq("id",o.user.id).single();if(s||!c){console.error("User not found in database:",s),await d.auth.signOut(),i("/",{replace:!0}),r(!1);return}y(o.user.id),p(!0)}else{const c=o.user.id;let s="/profile";typeof e=="function"?s=e(c):e.includes(":userId")?s=e.replace(":userId",c):s=`${e}/${c}`,i(s,{replace:!0}),r(!1);return}}catch(o){console.error("Authentication error:",o),t&&i("/",{replace:!0}),r(!1);return}finally{setTimeout(()=>{r(!1)},1e3)}};return h?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:n.jsx(N,{className:"h-12 w-12 animate-spin text-blue-600"})}):g?n.jsx(n.Fragment,{children:a}):null}export{U as A,P as C,R as E,D as L,O as a};
